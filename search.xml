<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>逻辑回归</title>
      <link href="2021/01/19/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/"/>
      <url>2021/01/19/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/</url>
      
        <content type="html"><![CDATA[<p>逻辑回归是经典的分类问题，但是不要被名字所误导。这是一个分类算法。这篇文章将详细的讲述逻辑回归的各种问题，主要参考是吴恩达老师的机器学习和一些大佬的笔记之类的，希望一起加油，学好这个常规但是非常厉害的分类算法。</p><a id="more"></a><h2 id="什么是逻辑回归"><a href="#什么是逻辑回归" class="headerlink" title="什么是逻辑回归"></a>什么是逻辑回归</h2>]]></content>
      
      
      
        <tags>
            
            <tag> 机器学习 </tag>
            
            <tag> 逻辑回归 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>新的一天</title>
      <link href="2021/01/19/%E6%96%B0%E7%9A%84%E4%B8%80%E5%A4%A9/"/>
      <url>2021/01/19/%E6%96%B0%E7%9A%84%E4%B8%80%E5%A4%A9/</url>
      
        <content type="html"><![CDATA[<p>今天部署好了博客的大部分功能，开始以后每天写博客了。哈哈哈</p><a id="more"></a><p>欢迎大家参观我的博客相册,留言板a</p>]]></content>
      
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>机器学习第二天</title>
      <link href="2021/01/12/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%AC%E4%BA%8C%E5%A4%A9/"/>
      <url>2021/01/12/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%AC%E4%BA%8C%E5%A4%A9/</url>
      
        <content type="html"><![CDATA[<p>今天先是拿了自己的核酸检测证明，真的很慢，然后来到知易自习室开始自己的第二天认真学习</p>]]></content>
      
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>线性回归</title>
      <link href="2021/01/12/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/"/>
      <url>2021/01/12/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/</url>
      
        <content type="html"><![CDATA[<p>线性回归是机器学习最基本的智能算法，也是最容易上手的机器学习算法，简而言之，他就是说的是 一个事件的多个因素造成的，每一个因素都是 $\theta_{i}$ 的因子，从而决定一个事件的走向。本文从基本和公式推导到算法实现都详细介绍了线性回归的算法，欢迎大家留言交流啊啊。</p><a id="more"></a><h2 id="前期介绍-问答呈现"><a href="#前期介绍-问答呈现" class="headerlink" title="前期介绍(问答呈现)"></a>前期介绍(问答呈现)</h2><ul><li><strong>什么是线性回归？</strong><br>当我们求解一个问题，这个问题跟n个因素相关。我们需要求出每一个因素的权重$\theta_{i}(1&lt;=i&lt;=n)$ ,这个过程就叫做线性回归。</li></ul><p>比如我们求一个地区的房价，最起码和房价相关的因素应该有 <strong>地区、面积、户型</strong> 等，我们就可以得到下面表达式。其中$\theta_{0}$ 是常数项的一个权值，也就是我们初中的y=ax+b中的b，而$x_{0}$ 只是为了配合前面的<strong>b</strong> 而特地添加的，并无实际的意义，一般设为1，这样 1*b=b。不影响最后的结果。</p><p>$$Y_{price}=\theta_{0}x_{0}+\theta_{1}x_{1}+\theta_{2}x_{2}+…+\theta_{n}x_{n}$$</p><p>   而求解$\theta_{i}$的过程我们就叫做线性回归。</p><ul><li><strong>什么是梯度下降？</strong><br>梯度下降是运用了偏微分的思想来求解$\theta_{i}$的一种思路<strong>。</strong>在多变量函数中，梯度是一个向量，向量有方向，梯度的方向就指出了函数在给定点的上升最快的方向**</li></ul><ul><li><p><strong>什么是代价函数？</strong><br>在机器学习中，没有完美的权值。我们赋的初始值和最终通过迭代求的最终值都有误差。而代价函数就是为了去表示这个误差。一般的代价函数表示如下。其中m是值数据的条数。y是指真实的结果。我们的测试数据就是一个m行n+1列的数据集，其中前n列是n个参数。最后一列代表着值。</p><p>$$<br>cost=1/m\sum_{i=1}^m(y_{i}-h_{\theta} (x_{i}))^{2}<br>$$</p></li></ul><p>$$<br> h_{\theta}(x)=\theta_{0}x_{0}+\theta_{1}x_{1}+\theta_{2}x_{2}+…+\theta_{n}x_{n}<br>$$<br>Q：至于为什么$(y_{i}-h_{\theta}(x_{i}))^{2}$为什么要平方？<br>A：因为我们通过权值求出来的值和真实值大小不好确定，所以我们采取平方的方法来减少因为正负带来的误差抵消。<br>Q：为什么要1/m？<br>A：我们最终求得是一个平均代价。其中这里面并没有太多的关系，因为我们的目标是使cost变小。我们给cost乘一个常数并不会影响最后的变大变小的趋势，不除m或者乘100也是没有关系的。</p><ul><li><strong>偏导？</strong><br>偏导就是我们一个方程有多个未知数，我们不可能对所有的未知数全部求导。我们一次只能对一个参数进行求导。例：</li></ul><p> $$<br>  Y(\theta_{1},\theta_{2}) = m* \theta_{1}+b* \theta_{2}<br> $$</p><p> $$<br> \frac{dY}{d\theta_{1}}=m<br> $$</p><h2 id="梯度下降"><a href="#梯度下降" class="headerlink" title="梯度下降"></a>梯度下降</h2><h3 id="1-梯度下降干什么"><a href="#1-梯度下降干什么" class="headerlink" title="1.梯度下降干什么"></a>1.梯度下降干什么</h3><p>我们前文讲到代价函数，我们的目标是使这个代价函数最小（趋近于0）.这样我们就可以拿到我们想要的权值。但是怎么让一个多元的函数最小呢。<br>1.暴力（遍历所有的可能）不可取，因为数据维度（有很多个相关参数）太大，参数取值无范围。这样岂不是要暴力到猴年马月。<br>2.智取。我们可以想象一元两次方程$y=x^2+4$我们可以先求导数，然后令导数等于0，这样我们就可以在那一点求得驻点，然后我们可以分析这个点是不是最大值或者最小值。<br>我们也可以在某一点求导数，比如我们在x=2的地方求导=4 我们可以理解为在2后面的斜率是4.我们想让我们的y小，我们就去往反方向走。比如我们在-2求得要往正方向走才能使y变小。<br>其实在我们的多元函数中要想让函数值变得小（代价函数）。我们也应该沿着每一个参数小的方向走。<br><img src="/2021/01/12/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/20200812204304301.png"></p><h3 id="2-怎么运用梯度下降的方法来求最终的权值"><a href="#2-怎么运用梯度下降的方法来求最终的权值" class="headerlink" title="2.怎么运用梯度下降的方法来求最终的权值"></a>2.怎么运用梯度下降的方法来求最终的权值</h3><ol><li>首先我们先给一组（因为参数是n个，所以需要n+1个$\theta$）数（向量）来求最后的结果）</li><li>循环迭代，每次我们往梯度下降的方向改变一 点点。<h4 id="梳理公式"><a href="#梳理公式" class="headerlink" title="梳理公式"></a>梳理公式</h4>$$<br>h_{\theta}(x_{i})=\theta_{0}x_{0}+\theta_{1}x_{1}+\theta_{2}x_{2}+…+\theta_{n}x_{n}<br>\tag{拟合函数}<br>$$<br>$$<br>J(\theta)=1/m\sum_{i=1}^m(y^{i}-h_{\theta}(x^{i}))^{2} \tag{代价函数}<br>$$<br>公式说明：在拟合公式中，$\theta_{i}$当前已知的，因为已经假设了或者处在迭代期间，不管正确与否，反正当前已知。而x是要带入公式去求最后的拟合值的。（其中x也是已知的，因为这是我们的数据啊，因为这里我们要带入每一份数据的x）。我们姑且在这里面称x是变量。<br>在代价函数中，是关于$\theta$的一个多元函数。因为在这里面我们最终就是要求它。</li></ol><h4 id="推导过程"><a href="#推导过程" class="headerlink" title="推导过程"></a>推导过程</h4><p>目标：我们要使代价函数尽可能的小<br>方法：我们采取对每一个权值往低方向走。</p><ol><li>我们首先为代价函数的每一个$\theta$求偏导<br>$$<br>\frac {\delta J(\theta)} {\delta \theta_k}=\frac{1} {m}\sum_{i=1}^m(y^{i}-h_{\theta} (x^{i}) )x_k^i \tag{通式}<br>$$</li></ol><p>$$<br>\frac {\delta J(\theta)} {\delta \theta_1}=\frac{1}{m}\sum_{i=1}^m(y^{i}-h_{\theta} (x^{i}) )x_1^i \tag{$\theta_1$}<br>$$<br>$$<br>\frac {\delta J(\theta)}{\delta \theta}=&lt;\frac {\delta J(\theta)}{\delta \theta_0},\frac {\delta J(\theta)}{\delta \theta_1},\frac {\delta J(\theta)}{\delta \theta_2}…&gt;\tag{整体求出来是n+1个向量}<br>$$<br>2.正式推导（t+1是t的下一轮）<br>$$<br>J(\theta_{t+1})-J(\theta_{t})=(\theta_{t+1}-\theta_t)J(\theta_t)’+R(ignore)\tag{泰勒公式}<br>$$<br>若想<br>$$<br>J(\theta_{t+1})&lt;J(\theta_{t})<br>$$<br>则<br>$$<br>(\theta_{t+1}-\theta_t)J(\theta_t)’&lt;0<br>$$<br>可令<br>$$<br>(\theta_{t+1}-\theta_t)=-J(\theta_t)’<br>$$<br>可得<br>$$<br>J(\theta_{t+1})-J(\theta_{t})=-(J(\theta_t)’)^2&lt;=0<br>$$<br>所以在$J(\theta_{t+1})&lt;J(\theta_{t})$的目标下我们得到了$(\theta_{t+1}-\theta_t)=-J(\theta_t)’$。即$\theta_{t+1}=\theta_t-J(\theta_t)’$<br>由于泰勒公式只在$\theta_{t+1}-\theta_{t}$很小时才成立。我们不用刻意去让他们的差趋近于0，那样运算时间太长了。我们只要小一点就可以。所以我们引入$\alpha$学习率（步长）来让$\theta$变得慢。在机器学习中，$\alpha$通常取<strong>0.001，0.0001.</strong><br>我们得到了我们想要的使权值变好的公式。<br>Q：既然我们目标是使代价函数变成0，为什么不直接求出来最优解，而是一步步缓慢的去迭代。<br>A：（我的理解）这就变成了一个多元的函数求解的问题，我们可能需要带入一定多的数据进行求解。但这些数据中难免有噪音数据。即使我们用全部的数据都去求  然后最后实现类似平均值之类的话，也需要同时大量的内存消耗，还有就是求出来的解并不一定是全局的最优解，有可能是一个局部的最优解。欢迎讨论。</p><h3 id="代码实现。"><a href="#代码实现。" class="headerlink" title="代码实现。"></a>代码实现。</h3><h4 id="代价函数"><a href="#代价函数" class="headerlink" title="代价函数"></a>代价函数</h4><p>代价函数是为了计算总的一个损失的。是为了画图用。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">computerCost</span>(<span class="params">X, y, theta</span>):</span></span><br><span class="line">  <span class="comment"># X是一个m行、n列的矩阵。y是一个m行1列的矩阵，theta是 1 行，n 列的矩阵。</span></span><br><span class="line">  <span class="comment"># 计算代价，主要用于画图时模拟一下。</span></span><br><span class="line">  <span class="comment"># 实现对应元素相乘，有2种方式，一个是np.multiply()，另外一个是 *</span></span><br><span class="line">  <span class="keyword">return</span> (np.transpose(X * theta - y)) * (X * theta - y) / (<span class="number">2</span> * <span class="built_in">len</span>(y))</span><br></pre></td></tr></table></figure><h4 id="线性回归"><a href="#线性回归" class="headerlink" title="线性回归"></a>线性回归</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">linearRegression</span>(<span class="params">data, alpha, num_iters, isUnification</span>):</span></span><br><span class="line">    X = data[:, <span class="number">0</span>:-<span class="number">1</span>]  <span class="comment"># X是前n-1列，即自变量的列</span></span><br><span class="line">    y = data[:, -<span class="number">1</span>]  <span class="comment"># y对应最后一列，即函数值</span></span><br><span class="line">    m = <span class="built_in">len</span>(y)  <span class="comment"># 总的数据条数</span></span><br><span class="line">    col = data.shape[<span class="number">1</span>]  <span class="comment"># data的列数</span></span><br><span class="line">    <span class="keyword">if</span> isUnification:</span><br><span class="line">        X, mu, sigma = featureNormaliza(X)  <span class="comment"># 归一化 均值mu,标准差sigma,</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> X.shape[<span class="number">1</span>]&lt;=<span class="number">2</span> <span class="keyword">and</span> X.shape[<span class="number">1</span>]&gt;=<span class="number">1</span>:</span><br><span class="line">        plot_data(data)  <span class="comment"># 绘制数据的归一化效果</span></span><br><span class="line"></span><br><span class="line">    X = np.hstack((np.ones((m, <span class="number">1</span>)), X))  <span class="comment"># 在X前加一列1,这个是为了表示后面那个常数的，*1还是等于原来的数</span></span><br><span class="line">    theta = np.zeros((col, <span class="number">1</span>))  <span class="comment"># 初始化权值向量</span></span><br><span class="line">    y = y.reshape(-<span class="number">1</span>, <span class="number">1</span>)  <span class="comment"># 将行向量转化为列</span></span><br><span class="line">    theta, history = gradientDescent(X, y, theta, alpha, num_iters)</span><br><span class="line">    plotJ(history, num_iters)</span><br><span class="line">    <span class="keyword">return</span> theta  <span class="comment"># 返回和学习的结果theta</span></span><br></pre></td></tr></table></figure><h4 id="梯度下降-1"><a href="#梯度下降-1" class="headerlink" title="梯度下降"></a>梯度下降</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gradientDescent</span>(<span class="params">X, y, theta, alpha, num_iters</span>):</span></span><br><span class="line">    <span class="comment"># X是一个m行3列的一个矩阵、y是每一个Xi的函数值、theta是权值、alpha是每一次的步长（学习率）、num是迭代的次数</span></span><br><span class="line">    m = <span class="built_in">len</span>(y)</span><br><span class="line">    n = <span class="built_in">len</span>(theta)</span><br><span class="line">    history = np.zeros((num_iters, <span class="number">1</span>))  <span class="comment"># 记录每次迭代计算的代价值</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_iters):  <span class="comment"># 遍历迭代次数</span></span><br><span class="line">        h = np.dot(X, theta)  <span class="comment"># 计算内积，matrix可以直接乘</span></span><br><span class="line">        a = ((alpha / m) * (np.dot(np.transpose(X), h - y)))</span><br><span class="line">        theta = np.mat(theta - a)  <span class="comment"># 梯度的计算</span></span><br><span class="line">        history[i] = computerCost(X, y, theta)  <span class="comment"># 调用计算代价函数</span></span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">100000</span> == <span class="number">0</span>):</span><br><span class="line">            print(<span class="string">&#x27;总共&#x27;</span>, num_iters, <span class="string">&#x27; 当前迭代了&#x27;</span>, i / num_iters * <span class="number">100</span>, <span class="string">&#x27;%了&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> theta, history</span><br></pre></td></tr></table></figure><h4 id="总代码"><a href="#总代码" class="headerlink" title="总代码"></a>总代码</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib.font_manager <span class="keyword">import</span> FontProperties</span><br><span class="line"></span><br><span class="line">font = FontProperties(fname=<span class="string">r&quot;c:\\windows\\fonts\\simsun.ttc&quot;</span>, size=<span class="number">14</span>)  <span class="comment"># 解决windows环境下画图汉字乱码问题</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载数据</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loadtxtAndcsv_data</span>(<span class="params">fileName, split, dataType</span>):</span>  <span class="comment"># 参数名、分割标志、数据类型</span></span><br><span class="line">    <span class="keyword">return</span> np.loadtxt(fileName, delimiter=split, dtype=dataType)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 画三维数据图</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_data</span>(<span class="params">X</span>):</span></span><br><span class="line">    fig = plt.figure()</span><br><span class="line">    ax = fig.add_subplot(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, projection=<span class="string">&#x27;3d&#x27;</span>)</span><br><span class="line">    ax.scatter(X[:, <span class="number">0</span>], X[:, <span class="number">1</span>], X[:, <span class="number">2</span>])</span><br><span class="line">    ax.set_zlabel(<span class="string">&#x27;Y&#x27;</span>, fontdict=&#123;<span class="string">&#x27;size&#x27;</span>: <span class="number">15</span>, <span class="string">&#x27;color&#x27;</span>: <span class="string">&#x27;red&#x27;</span>&#125;)</span><br><span class="line">    ax.set_ylabel(<span class="string">&#x27;X2&#x27;</span>, fontdict=&#123;<span class="string">&#x27;size&#x27;</span>: <span class="number">15</span>, <span class="string">&#x27;color&#x27;</span>: <span class="string">&#x27;red&#x27;</span>&#125;)</span><br><span class="line">    ax.set_xlabel(<span class="string">&#x27;X1&#x27;</span>, fontdict=&#123;<span class="string">&#x27;size&#x27;</span>: <span class="number">15</span>, <span class="string">&#x27;color&#x27;</span>: <span class="string">&#x27;red&#x27;</span>&#125;)</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 画每次迭代代价的变化图</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plotJ</span>(<span class="params">history, num_iters</span>):</span></span><br><span class="line">    x = np.arange(<span class="number">1</span>, num_iters + <span class="number">1</span>)</span><br><span class="line">    plt.plot(x, history)</span><br><span class="line">    plt.xlabel(<span class="string">u&quot;迭代次数&quot;</span>, fontproperties=font)  <span class="comment"># 注意指定字体，要不然出现乱码问题</span></span><br><span class="line">    plt.ylabel(<span class="string">u&quot;代价值&quot;</span>, fontproperties=font)</span><br><span class="line">    plt.title(<span class="string">u&quot;代价随迭代次数的变化&quot;</span>, fontproperties=font)</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 归一化feature</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">featureNormaliza</span>(<span class="params">X</span>):</span></span><br><span class="line">    X_norm = np.array(X)  <span class="comment"># 将X转化为numpy数组对象，才可以进行矩阵的运算</span></span><br><span class="line">    <span class="comment"># 定义所需变量</span></span><br><span class="line">    mu = np.mean(X_norm, <span class="number">0</span>)  <span class="comment"># 求每一列的平均值（0指定为列，1代表行）</span></span><br><span class="line">    sigma = np.std(X_norm, <span class="number">0</span>)  <span class="comment"># 求每一列的标准差</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(X.shape[<span class="number">1</span>]):  <span class="comment"># 遍历列</span></span><br><span class="line">        X_norm[:, i] = (X_norm[:, i] - mu[i]) / sigma[i]  <span class="comment"># 归一化</span></span><br><span class="line">    <span class="keyword">return</span> X_norm, mu, sigma</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">computerCost</span>(<span class="params">X, y, theta</span>):</span></span><br><span class="line">    <span class="comment"># X是一个m行、n列的矩阵。y是一个m行1列的矩阵，theta是 1 行，n 列的矩阵。</span></span><br><span class="line">    <span class="comment"># 计算代价，主要用于画图时模拟一下。</span></span><br><span class="line">    <span class="comment"># 实现对应元素相乘，有2种方式，一个是np.multiply()，另外一个是 *</span></span><br><span class="line">    a = (np.transpose(X * theta - y))</span><br><span class="line">    b = (X * theta - y)</span><br><span class="line">    c = a * b</span><br><span class="line">    <span class="keyword">return</span> c / (<span class="number">2</span> * <span class="built_in">len</span>(y))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 梯度下降算法</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gradientDescent</span>(<span class="params">X, y, theta, alpha, num_iters</span>):</span></span><br><span class="line">    <span class="comment"># X是一个m行3列的一个矩阵、y是每一个Xi的函数值、theta是权值、alpha是每一次的步长（学习率）、num是迭代的次数</span></span><br><span class="line">    m = <span class="built_in">len</span>(y)</span><br><span class="line">    n = <span class="built_in">len</span>(theta)</span><br><span class="line">    history = np.zeros((num_iters, <span class="number">1</span>))  <span class="comment"># 记录每次迭代计算的代价值</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_iters):  <span class="comment"># 遍历迭代次数</span></span><br><span class="line">        h = np.dot(X, theta)  <span class="comment"># 计算内积，matrix可以直接乘</span></span><br><span class="line">        a = ((alpha / m) * (np.dot(np.transpose(X), h - y)))</span><br><span class="line">        theta = np.mat(theta - a)  <span class="comment"># 梯度的计算</span></span><br><span class="line">        history[i] = computerCost(X, y, theta)  <span class="comment"># 调用计算代价函数</span></span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">100000</span> == <span class="number">0</span>):</span><br><span class="line">            print(<span class="string">&#x27;总共&#x27;</span>, num_iters, <span class="string">&#x27; 当前迭代了&#x27;</span>, i / num_iters * <span class="number">100</span>, <span class="string">&#x27;%了&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> theta, history</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">linearRegression</span>(<span class="params">data, alpha, num_iters, isUnification</span>):</span></span><br><span class="line">    X = data[:, <span class="number">0</span>:-<span class="number">1</span>]  <span class="comment"># X是前n-1列，即自变量的列</span></span><br><span class="line">    y = data[:, -<span class="number">1</span>]  <span class="comment"># y对应最后一列，即函数值</span></span><br><span class="line">    m = <span class="built_in">len</span>(y)  <span class="comment"># 总的数据条数</span></span><br><span class="line">    col = data.shape[<span class="number">1</span>]  <span class="comment"># data的列数</span></span><br><span class="line">    <span class="keyword">if</span> isUnification:</span><br><span class="line">        X, mu, sigma = featureNormaliza(X)  <span class="comment"># 归一化 均值mu,标准差sigma,</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> X.shape[<span class="number">1</span>]&lt;=<span class="number">2</span> <span class="keyword">and</span> X.shape[<span class="number">1</span>]&gt;=<span class="number">1</span>:</span><br><span class="line">        plot_data(data)  <span class="comment"># 绘制数据的归一化效果</span></span><br><span class="line"></span><br><span class="line">    X = np.hstack((np.ones((m, <span class="number">1</span>)), X))  <span class="comment"># 在X前加一列1,这个是为了表示后面那个常数的，*1还是等于原来的数</span></span><br><span class="line">    theta = np.zeros((col, <span class="number">1</span>))  <span class="comment"># 初始化权值向量</span></span><br><span class="line">    y = y.reshape(-<span class="number">1</span>, <span class="number">1</span>)  <span class="comment"># 将行向量转化为列</span></span><br><span class="line">    theta, history = gradientDescent(X, y, theta, alpha, num_iters)</span><br><span class="line">    plotJ(history, num_iters)</span><br><span class="line">    <span class="keyword">return</span> theta  <span class="comment"># 返回和学习的结果theta</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试学习效果（预测）</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict</span>(<span class="params">mu, sigma, theta</span>):</span>  <span class="comment"># 每一列的平均值，平均差，权值</span></span><br><span class="line">    predict = np.array([<span class="number">1650</span>, <span class="number">3</span>])</span><br><span class="line">    norm_predict = (predict - mu) / sigma</span><br><span class="line">    final_predict = np.hstack((np.ones((<span class="number">1</span>)), norm_predict))</span><br><span class="line">    result = np.dot(final_predict, theta)  <span class="comment"># 预测结果</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    isUnification = <span class="literal">False</span>  <span class="comment"># 是否归一化, 归一化后 测试数据也要归一化才能进行预测。</span></span><br><span class="line">    alpha = <span class="number">0.000001</span>  <span class="comment"># 学习率</span></span><br><span class="line">    num_iter = <span class="number">50000</span>  <span class="comment"># 迭代次数</span></span><br><span class="line"></span><br><span class="line">    data = loadtxtAndcsv_data(<span class="string">&quot;data.txt&quot;</span>, <span class="string">&quot;,&quot;</span>, np.float64)  <span class="comment"># 读取数据</span></span><br><span class="line">    theta = linearRegression(data, alpha, num_iter, isUnification)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(theta)):  <span class="comment"># 输出权值</span></span><br><span class="line">        print(<span class="string">&#x27;权值&#x27;</span>, i, <span class="string">&#x27;=&#x27;</span>, theta[i][<span class="number">0</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="数据生成代码"><a href="#数据生成代码" class="headerlink" title="数据生成代码"></a>数据生成代码</h3><p><a href="https://github.com/getlxc/ml">GitHub</a><br><strong>如果感觉还可以麻烦给个star。</strong><br>数据可视化：<br><img src="/2021/01/12/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/20200813215918452.png" alt="在这里插入图片描述"><br><img src="/2021/01/12/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/20200813220212223.png" alt="在这里插入图片描述"></p><center>两张图片参数不一致，数据量不一致，但可以看到基本在一个平面内</center><h2 id="问答"><a href="#问答" class="headerlink" title="问答"></a>问答</h2><ul><li>Q:梯度下降？批量梯度下降？随机梯度下降？小批量梯度下降？<br>A:梯度下降就是一个算法总称，或者你可以理解成一个批量梯度下降的一个特殊形式，只有一条数据。批量梯度下降是我们本文重点讲解的。有很多条数据来求最终的权值。<br>随机梯度下降是批量梯度下降的一种缩减形式（一般用的最多）。<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">h = np.dot(X, theta)  <span class="comment"># 计算内积，matrix可以直接乘</span></span><br><span class="line">a = ((alpha / m) * (np.dot(np.transpose(X), h - y)))</span><br><span class="line">theta = np.mat(theta - a)  <span class="comment"># 梯度的计算</span></span><br></pre></td></tr></table></figure>上面代码是<strong>批量梯度下降</strong>的，我们每次计算下一轮的权值都要把m条数据统统计算一遍，才能得到下一轮的权值。这样太费时间了，随机梯度下降就是我们只取出其中一条数据来计算下一轮的权值，因为只取一条，所以风险很大，因为这一条数据也许是一个激进的数据，这一轮的权值有可能对比上一轮的权值会差别很大。但是有风险肯定有优点，他说不准就会脱离一个局部最优解，进入全局最优解。<br>而小批量梯度下降是 批量和随机的一个结合。我们随机选10（小批量）条数据，不用选全部的，也没必要冒风险只选一条数据。</li></ul><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ol><li>我们什么时候用归一化？<br>归一化就是把数据 统一归到一个小范围内<br>当我们的数据不同维度的权重差别很大，比如，我们y=ax1+bx2+c   我们可能知道a这个权值很大，也就是说x1对y的影响很大。是b的1000倍，这时候我们就需要把数据进行归一化，因为 我们初始权值是一样的 我们的步长也是固定不变的，如果不进行归一化，每次对于b来说可能改变的太多了，而对于a来说只是一点点。<br>归一化之后，迭代次数要更多才能达到类似的效果，当数据值太大如果不归一下，可能就得不到最优的解。对比<br>没归一化1000次迭代就差不多了</li></ol><p><img src="/2021/01/12/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/20200813215641359.png" alt="在这里插入图片描述"><br>有了归一化要迭代百万级才能（因为都缩小到很小的范围内，导数都很小，改变慢）：</p><ol start="2"><li>学习率怎么选<br>我们的数据值大小很大时(&gt;100)，我们需要把学习率设置的小一点 10E-6就可，否则一点点的改变也许就跳过了最优解进入了发散的状态。<br><img src="/2021/01/12/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/20200813214542383.png" alt="在这里插入图片描述">{:height=”100” width=”100”}<h2 id="感谢一下博客或者up主让我明白了梯度下降"><a href="#感谢一下博客或者up主让我明白了梯度下降" class="headerlink" title="感谢一下博客或者up主让我明白了梯度下降"></a>感谢一下博客或者up主让我明白了梯度下降</h2></li><li><a href="https://blog.csdn.net/qq_41800366/article/details/86583789">有计算过程，很详细</a></li><li><a href="https://space.bilibili.com/410922661">B站up主链接</a></li><li><a href="https://github.com/lawlite19/MachineLearning_Python">Python算法借鉴</a></li><li>欢迎留言交流</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> 线性回归 </tag>
            
            <tag> 机器学习 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
    
    
    <entry>
      <title>archives</title>
      <link href="archives/index.html"/>
      <url>archives/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>categories</title>
      <link href="categories/index.html"/>
      <url>categories/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>留言板</title>
      <link href="messageWall/index.html"/>
      <url>messageWall/index.html</url>
      
        <content type="html"><![CDATA[<div align="center">  <div>不用多说了吧！</div>  <img src="https://cdn.jsdelivr.net/gh/getlxc/getlxc.github.io@master/pinglun.gif" style="height: 100px; width:100px ;"></div><section id="comments" class="comments">  <style>    .comments {      margin: 30px;      padding: 10px;      background: #fff;    }    @media screen and (max-width: 800px) {      .comments {        margin: auto;        padding: 10px;        background: #fff;      }    }  </style>  <div id="vcomment" class="comment"></div>  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>  <script>    var notify = true;    var verify = false;    window.onload = function () {      new Valine({        el: ".comment",        notify: notify,        verify: verify,        app_id: "x4vK6NKjGP1VyxFvykeywDkw-gzGzoHsz",        app_key: "iRxdLiHhczUC4I51dwkz0qpv",        placeholder: "评论下相册吧！！",        avatar:          "https://cdn.jsdelivr.net/gh/getlxc/getlxc.github.io@master/img/head_icon.jpg",      });    };  </script></section>]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="photos/data.json"/>
      <url>photos/data.json</url>
      
        <content type="html"><![CDATA[{"list":[{"date":"2020-12","arr":{"year":2020,"month":12,"link":["2020-12-30_上海外滩拍照.png","2020-12-31_东方明珠拍照.png"],"text":["上海外滩拍照","东方明珠拍照"],"type":["image","image"]}},{"date":"2020-11","arr":{"year":2020,"month":11,"link":["2020-11-27_南京夫子庙.png","2020-11-27_南京秦淮河.png"],"text":["南京夫子庙","南京秦淮河"],"type":["image","image"]}}]}]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>相册</title>
      <link href="photos/index.html"/>
      <url>photos/index.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="./ins.css"><div class="photos-btn-wrap"><a class="photos-btn active" href="javascript:void(0)">Photos</a><a class="photos-btn" href="/photos/videos.html">Videos</a></div><div class="instagram itemscope"><a href="https://www.instagram.com/lawlitewang20/" target="_blank" class="open-ins">图片正在加载中…</a></div><script>  (function() {    var loadScript = function(path) {      var $script = document.createElement('script')      document.getElementsByTagName('body')[0].appendChild($script)      $script.setAttribute('src', path)    }    setTimeout(function() {      loadScript('./ins.js')    }, 0)  })()</script>  <section id="comments" class="comments">    <style>      .comments{margin:30px;padding:10px;background:#fff}      @media screen and (max-width:800px){.comments{margin:auto;padding:10px;background:#fff}}    </style>    <div id="vcomment" class="comment"></div>     <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>    <script src="//unpkg.com/valine/dist/Valine.min.js"></script>    <script>       var notify = true;       var verify = false;        window.onload = function() {            new Valine({                el: '.comment',                notify: notify,                verify: verify,                app_id: "x4vK6NKjGP1VyxFvykeywDkw-gzGzoHsz",                app_key: "iRxdLiHhczUC4I51dwkz0qpv",                placeholder: "评论下相册吧！！",                avatar:"https://cdn.jsdelivr.net/gh/getlxc/getlxc.github.io@master/img/head_icon.jpg"            });        }    </script></section>]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="photos/ins.css"/>
      <url>photos/ins.css</url>
      
        <content type="html"><![CDATA[#post-instagram{padding: 30px;}#post-instagram .article-entry{padding-right: 0;}/* ====== video ===== */.video-container {    z-index: 1;    position: relative;    padding-bottom: 56.25%;    margin: 0 auto;}.video-container iframe, .video-container object, .video-container embed {    z-index: 1;    position: absolute;    top: 0;    left: 7%;    width: 85%;    height: 85%;    box-shadow: 0px 0px 20px 2px #888888;}.instagram{position: relative;min-height: 500px;}.instagram img {width: 100%;}.instagram .year {font-size: 16px;}.instagram .open-ins{padding: 10px 0;color: #cdcdcd;}.instagram .open-ins:hover{color: #657b83;}.instagram .year{display: inline;}.instagram .thumb {width: 25%;height: 0; padding-bottom: 25%;position: relative;display: inline-block;text-align: center;background: #ededed;outline: 1px solid #ddd;}.instagram .thumb a {position: relative;}.instagram .album h1 em{font-style: normal;font-size: 14px;margin-left: 10px;}.instagram .album ul{display: flex;flex-wrap: wrap;clear: both;width: 100%;text-align: left;}.instagram .album li{list-style: none;display: inline-block;box-sizing: border-box;padding: 0 5px;margin-bottom: -10px;height: 0;width: 25%;position: relative;padding-bottom: 25%;}.instagram .album li:before{display: none;}.instagram .album div.img-box{position: absolute;width: 90%;height: 90%;-webkit-box-shadow: 0 1px 0 rgba(255,255,255,0.4), 0 1px 0 1px rgba(255,255,255,0.1);-moz-box-shadow: 0 1px 0 rgba(255,255,255,0.4), 0 1px 0 1px rgba(255,255,255,0.1);box-shadow: 0 1px 0 rgba(255,255,255,0.4), 0 1px 0 1px rgba(255,255,255,0.1);}.instagram .album div.img-box img{width: 100%;height: 100%;    position: absolute;    z-index: 2;}.instagram .album div.img-box .img-bg{position: absolute;top: 0;left: 0;bottom: 0px;width: 100%;margin: -5px;padding: 5px;-webkit-box-shadow: 0 0 0 1px rgba(0,0,0,.04), 0 1px 5px rgba(0,0,0,0.1);-moz-box-shadow: 0 0 0 1px rgba(0,0,0,.04), 0 1px 5px rgba(0,0,0,0.1);box-shadow: 0 0 0 1px rgba(0,0,0,.04), 0 1px 5px rgba(0,0,0,0.1);-webkit-transition: all 0.15s ease-out 0.1s;-moz-transition: all 0.15s ease-out 0.1s;-o-transition: all 0.15s ease-out 0.1s;transition: all 0.15s ease-out 0.1s;opacity: 0.2;cursor: pointer;display: block;z-index: 3;}.instagram .album div.img-box .icon {    font-size: 14px;    position: absolute;    left: 50%;    top: 50%;    margin-left: -7px;    margin-top: -7px;    color: #999;    z-index: 1;}.instagram .album div.img-box .img-bg:hover{opacity: 0;}.photos-btn-wrap {border-bottom: 1px solid #e5e5e5;margin-bottom: 20px;}.photos-btn {font-size: 16px;color: #333;margin-bottom: -4px;padding: 5px 8px 3px;}.photos-btn.active {color: #08c;border: 1px solid #e5e5e5;border-bottom: 5px solid #fff;}@media screen and (max-width:600px) {.instagram .thumb {width: 50%;padding-bottom: 50%;}.instagram .album li {width: 100%;position: relative;padding-bottom: 100%;text-align: center;}.instagram .album div.img-box{margin: 0;width: 90%;height: 90%;}}]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="photos/lazyload.min.js"/>
      <url>photos/lazyload.min.js</url>
      
        <content type="html"><![CDATA[/*! * An jQuery | zepto plugin for lazy loading images. * author -> jieyou * see https://github.com/jieyou/lazyload * use some tuupola's code https://github.com/tuupola/jquery_lazyload (BSD) * use component's throttle https://github.com/component/throttle (MIT) */!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(window.jQuery||window.Zepto)}(function(a){function g(){}function h(a,b){var e;return e=b._$container==d?("innerHeight"in c?c.innerHeight:d.height())+d.scrollTop():b._$container.offset().top+b._$container.height(),e<=a.offset().top-b.threshold}function i(b,e){var f;return f="e._$container==d?d.width()+(a.fn.scrollLeft?d.scrollLeft():c.pageXOffset):e._$container.offset().left+e._$container.width(),f<=b.offset().left-e.threshold}function" j(a,b){var c;return c="b._$container==d?d.scrollTop():b._$container.offset().top,c">=a.offset().top+b.threshold+a.height()}function k(b,e){var f;return f=e._$container==d?a.fn.scrollLeft?d.scrollLeft():c.pageXOffset:e._$container.offset().left,f>=b.offset().left+e.threshold+b.width()}function l(a,b){var c=0;a.each(function(d){function g(){f.trigger("_lazyload_appear"),c=0}var f=a.eq(d);if(!(f.width()<=0&&f.height()<=0||"none"===f.css("display")))if(b.vertical_only)if(j(f,b));else if(h(f,b)){if(++c>b.failure_limit)return!1}else g();else if(j(f,b)||k(f,b));else if(h(f,b)||i(f,b)){if(++c>b.failure_limit)return!1}else g()})}function m(a){return a.filter(function(b){return!a.eq(b)._lazyload_loadStarted})}function n(a,b){function h(){f=0,g=+new Date,e=a.apply(c,d),c=null,d=null}var c,d,e,f,g=0;return function(){c=this,d=arguments;var a=new Date-g;return f||(a>=b?h():f=setTimeout(h,b-a)),e}}var f,c=window,d=a(c),e={threshold:0,failure_limit:0,event:"scroll",effect:"show",effect_params:null,container:c,data_attribute:"original",data_srcset_attribute:"original-srcset",skip_invisible:!0,appear:g,load:g,vertical_only:!1,check_appear_throttle_time:300,url_rewriter_fn:g,no_fake_img_loader:!1,placeholder_data_img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC",placeholder_real_img:"http://ditu.baidu.cn/yyfm/lazyload/0.0.1/img/placeholder.png"};f=function(){var a=Object.prototype.toString;return function(b){return a.call(b).replace("[object ","").replace("]","")}}(),a.fn.hasOwnProperty("lazyload")||(a.fn.lazyload=function(b){var i,j,k,h=this;return a.isPlainObject(b)||(b={}),a.each(e,function(g,h){var i=f(b[g]);-1!=a.inArray(g,["threshold","failure_limit","check_appear_throttle_time"])?"String"==i?b[g]=parseInt(b[g],10):"Number"!=i&&(b[g]=h):"container"==g?(b._$container=b.hasOwnProperty(g)?b[g]==c||b[g]==document?d:a(b[g]):d,delete b.container):!e.hasOwnProperty(g)||b.hasOwnProperty(g)&&i==f(e[g])||(b[g]=h)}),i="scroll"==b.event,k=0==b.check_appear_throttle_time?l:n(l,b.check_appear_throttle_time),j=i||"scrollstart"==b.event||"scrollstop"==b.event,h.each(function(c){var e=this,f=h.eq(c),i=f.attr("src"),k=f.attr("data-"+b.data_attribute),l=b.url_rewriter_fn==g?k:b.url_rewriter_fn.call(e,f,k),n=f.attr("data-"+b.data_srcset_attribute),o=f.is("img");return 1==f._lazyload_loadStarted||i==l?(f._lazyload_loadStarted=!0,h=m(h),void 0):(f._lazyload_loadStarted=!1,o&&!i&&f.one("error",function(){f.attr("src",b.placeholder_real_img)}).attr("src",b.placeholder_data_img),f.one("_lazyload_appear",function(){function i(){d&&f.hide(),o?(n&&f.attr("srcset",n),l&&f.attr("src",l)):f.css("background-image",'url("'+l+'")'),d&&f[b.effect].apply(f,c?b.effect_params:[]),h=m(h)}var d,c=a.isArray(b.effect_params);f._lazyload_loadStarted||(d="show"!=b.effect&&a.fn[b.effect]&&(!b.effect_params||c&&0==b.effect_params.length),b.appear!=g&&b.appear.call(e,f,h.length,b),f._lazyload_loadStarted=!0,b.no_fake_img_loader||n?(b.load!=g&&f.one("load",function(){b.load.call(e,f,h.length,b)}),i()):a("<img>").one("load",function(){i(),b.load!=g&&b.load.call(e,f,h.length,b)}).attr("src",l))}),j||f.on(b.event,function(){f._lazyload_loadStarted||f.trigger("_lazyload_appear")}),void 0)}),j&&b._$container.on(b.event,function(){k(h,b)}),d.on("resize load",function(){k(h,b)}),a(function(){k(h,b)}),this})});</=0&&f.height()<=0||"none"===f.css("display")))if(b.vertical_only)if(j(f,b));else></=a.offset().top-b.threshold}function>]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>相册</title>
      <link href="photos/videos.html"/>
      <url>photos/videos.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" href="./ins.css"><div class="photos-btn-wrap"><a class="photos-btn" href="/photos">Photos</a><a class="photos-btn active" href="/photos/videos.html">Videos</a></div><center>    <h1>十里洋场烟花地</h1></center><hr><center>    <div class="video-container">        <iframe height="80%" width="80%" src="https://cdn.jsdelivr.net/gh/getlxc/getlxc.github.io@master/video/shanghai.mp4" frameborder="0" allowfullscreen></iframe>    </div></center>]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="photos/ins.js"/>
      <url>photos/ins.js</url>
      
        <content type="html"><![CDATA[/******//******/(function(modules) { // webpackBootstrap  /******/ // The module cache  /******/  var installedModules = {};  /******/  /******/ // The require function  /******/  function __webpack_require__(moduleId) {      /******/      /******/ // Check if module is in cache      /******/      if (installedModules[moduleId])      /******/          return installedModules[moduleId].exports;      /******/      /******/ // Create a new module (and put it into the cache)      /******/      var module = installedModules[moduleId] = {          /******/          exports: {},          /******/          id: moduleId,          /******/          loaded: false          /******/      };      /******/      /******/ // Execute the module function      /******/      modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);      /******/      /******/ // Flag the module as loaded      /******/      module.loaded = true;      /******/      /******/ // Return the exports of the module      /******/      return module.exports;      /******/  }  /******/  /******/  /******/ // expose the modules object (__webpack_modules__)  /******/  __webpack_require__.m = modules;  /******/  /******/ // expose the module cache  /******/  __webpack_require__.c = installedModules;  /******/  /******/ // __webpack_public_path__  /******/  __webpack_require__.p = "/dist/";  /******/  /******/ // Load entry module and return exports  /******/  return __webpack_require__(0);  /******/})/************************************************************************//******/([  /* 0 */  /***/  function(module, exports, __webpack_require__) {      'use strict';      __webpack_require__(1);      var _view = __webpack_require__(2);      var _view2 = _interopRequireDefault(_view);      function _interopRequireDefault(obj) {          return obj && obj.__esModule ? obj : {              default: obj          };      }      /**       * @name impush-client       * @description 这个项目让我发家致富…       * @date 2016-12-1       */      var _collection = [];      var _count = 0;      var searchData;      function addMask(elem) {          var rect = elem.getBoundingClientRect();          var style = getComputedStyle(elem, null);          var mask = document.createElement('i');          mask.className = 'icon-film';          mask.style.color = '#fff';          mask.style.fontSize = '26px';          mask.style.position = 'absolute';          mask.style.right = '10px';          mask.style.bottom = '10px';          mask.style.zIndex = 1;          elem.parentNode.appendChild(mask);      }      var createVideoIncon = function createVideoIncon() {          var $videoImg = document.querySelectorAll('.thumb a[data-type="video"]');          for (var i = 0, len = $videoImg.length; i < len; i++) {              addMask($videoImg[i]);          }      };      var render = function render(res) {          var ulTmpl = "";          for (var j = 0, len2 = res.list.length; j < len2; j++) {              var data = res.list[j].arr;              var liTmpl = "";              for (var i = 0, len = data.link.length; i < len; i++) {                  /*var minSrc = 'https://raw.githubusercontent.com/ainimini/Picture/master/' + data.link[i];                  var src = 'https://raw.githubusercontent.com/ainimini/Picture/master/' + data.link[i];*/                  var minSrc = 'https://cdn.jsdelivr.net/gh/getlxc/getlxc.github.io@photo/min_photos/' + data.link[i];                  var src = 'https://cdn.jsdelivr.net/gh/getlxc/getlxc.github.io@photo/photos/' + data.link[i];                  var type = data.type[i];                  var target = src + (type === 'video' ? '.mp4' : '.jpg');                  src += '';                  liTmpl += '<figure class="thumb" itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">\              <a href="' + src + '" itemprop="contentUrl" data-size="1080x1080" data-type="' + type + '" data-target="' + src + '">\                <img class="reward-img" data-type="' + type + '" data-src="' + minSrc + '" src="/assets/img/empty.png" itemprop="thumbnail" onload="lzld(this)">\              </a>\              <figcaption style="display:none" itemprop="caption description">' + data.text[i] + '</figcaption>\          </figure>';              }              ulTmpl = ulTmpl + '<section class="archives album"><h1 class="year">' + data.year + '年<em>' + data.month + '月</em></h1>\      <ul class="img-box-ul">' + liTmpl + '</ul>\      </section>';          }          document.querySelector('.instagram').innerHTML = '<div class="photos" itemscope itemtype="http://schema.org/ImageGallery">' + ulTmpl + '</div>';          createVideoIncon();          _view2.default.init();      };      var replacer = function replacer(str) {          var arr = str.split("/");          return "/assets/ins/" + arr[arr.length - 1];      };      var ctrler = function ctrler(data) {          var imgObj = {};          for (var i = 0, len = data.length; i < len; i++) {              var y = data[i].y;              var m = data[i].m;              var src = replacer(data[i].src);              var text = data[i].text;              var key = y + "" + ((m + "").length == 1 ? "0" + m : m);              if (imgObj[key]) {                  imgObj[key].srclist.push(src);                  imgObj[key].text.push(text);              } else {                  imgObj[key] = {                      year: y,                      month: m,                      srclist: [src],                      text: [text]                  };              }          }          render(imgObj);      };      function loadData(success) {          if (!searchData) {              var xhr = new XMLHttpRequest();              xhr.open('GET', './data.json?t=' + +new Date(), true);              xhr.onload = function() {                  if (this.status >= 200 && this.status < 300) {                      var res = JSON.parse(this.response);                      searchData = res;                      success(searchData);                  } else {                      console.error(this.statusText);                  }              };              xhr.onerror = function() {                  console.error(this.statusText);              };              xhr.send();          } else {              success(searchData);          }      }      var Ins = {          init: function init() {              loadData(function(data) {                  render(data);              });          }      };      Ins.init();      // export default impush;      /***/  },  /* 1 */  /***/  function(module, exports, __webpack_require__) {      /* WEBPACK VAR INJECTION */      (function(global) {          'use strict';          var inViewport = __webpack_require__(3);          var lazyAttrs = ['data-src'];          global.lzld = lazyload();          // Provide libs using getAttribute early to get the good src          // and not the fake data-src          replaceGetAttribute('Image');          replaceGetAttribute('IFrame');          function registerLazyAttr(attr) {              if (indexOf.call(lazyAttrs, attr) === -1) {                  lazyAttrs.push(attr);              }          }          function lazyload(opts) {              opts = merge({                  'offset': 333,                  'src': 'data-src',                  'container': false              }, opts || {});              if (typeof opts.src === 'string') {                  registerLazyAttr(opts.src);              }              var elts = [];              function show(elt) {                  var src = findRealSrc(elt);                  if (src) {                      elt.src = src;                  }                  elt.setAttribute('data-lzled', true);                  elts[indexOf.call(elts, elt)] = null;              }              function findRealSrc(elt) {                  if (typeof opts.src === 'function') {                      return opts.src(elt);                  }                  return elt.getAttribute(opts.src);              }              function register(elt) {                  elt.onload = null;                  elt.removeAttribute('onload');                  elt.onerror = null;                  elt.removeAttribute('onerror');                  if (indexOf.call(elts, elt) === -1) {                      inViewport(elt, opts, show);                  }              }              return register;          }          function replaceGetAttribute(elementName) {              var fullname = 'HTML' + elementName + 'Element';              if (fullname in global === false) {                  return;              }              var original = global[fullname].prototype.getAttribute;              global[fullname].prototype.getAttribute = function(name) {                  if (name === 'src') {                      var realSrc;                      for (var i = 0, max = lazyAttrs.length; i < max; i++) {                          realSrc = original.call(this, lazyAttrs[i]);                          if (realSrc) {                              break;                          }                      }                      return realSrc || original.call(this, name);                  }                  // our own lazyloader will go through theses lines                  // because we use getAttribute(opts.src)                  return original.call(this, name);              };          }          function merge(defaults, opts) {              for (var name in defaults) {                  if (opts[name] === undefined) {                      opts[name] = defaults[name];                  }              }              return opts;          }          // http://webreflection.blogspot.fr/2011/06/partial-polyfills.html          function indexOf(value) {              for (var i = this.length; i-- && this[i] !== value;) {}              return i;          }          module.exports = lazyload;          // export default impush;          /* WEBPACK VAR INJECTION */      }.call(exports, (function() {          return this;      }())))      /***/  },  /* 2 */  /***/  function(module, exports) {      'use strict';      var initPhotoSwipeFromDOM = function initPhotoSwipeFromDOM(gallerySelector) {          // parse slide data (url, title, size ...) from DOM elements          // (children of gallerySelector)          var parseThumbnailElements = function parseThumbnailElements(el) {              el = el.parentNode.parentNode;              var thumbElements = el.getElementsByClassName('thumb'),                  numNodes = thumbElements.length,                  items = [],                  figureEl,                  linkEl,                  size,                  type,                  // video or not                  target,                  item;              for (var i = 0; i < numNodes; i++) {                  figureEl = thumbElements[i]; //                  // include only element nodes                  if (figureEl.nodeType !== 1) {                      continue;                  }                  linkEl = figureEl.children[0]; //                  size = linkEl.getAttribute('data-size').split('x');                  type = linkEl.getAttribute('data-type');                  target = linkEl.getAttribute('data-target');                  // create slide object                  item = {                      src: linkEl.getAttribute('href'),                      w: parseInt(size[0], 10),                      h: parseInt(size[1], 10)                  };                  if (figureEl.children.length > 1) {                      item.title = figureEl.children[1].innerHTML;                  }                  if (linkEl.children.length > 0) {                      item.msrc = linkEl.children[0].getAttribute('src');                      item.type = type;                      item.target = target;                      item.html = '<video src="' + target + '" controls="controls" autoplay="autoplay"></video>';                      if (type === 'video') {                          //item.src = null;                      }                  }                  item.el = figureEl; // save link to element for getThumbBoundsFn                  items.push(item);              }              return items;          };          // find nearest parent element          var closest = function closest(el, fn) {              return el && (fn(el) ? el : closest(el.parentNode, fn));          };          // triggers when user clicks on thumbnail          var onThumbnailsClick = function onThumbnailsClick(e) {              e = e || window.event;              e.preventDefault ? e.preventDefault() : e.returnValue = false;              var eTarget = e.target || e.srcElement;              // find root element of slide              var clickedListItem = closest(eTarget, function(el) {                  return el.tagName && el.tagName.toUpperCase() === 'FIGURE';              });              if (!clickedListItem) {                  return;              }              // find index of clicked item by looping through all child nodes              // alternatively, you may define index via data- attribute              var clickedGallery = clickedListItem.parentNode,                  // childNodes = clickedListItem.parentNode.childNodes,                  // numChildNodes = childNodes.length,                  childNodes = document.getElementsByClassName('thumb'),                  numChildNodes = childNodes.length,                  nodeIndex = 0,                  index;              for (var i = 0; i < numChildNodes; i++) {                  if (childNodes[i].nodeType !== 1) {                      continue;                  }                  if (childNodes[i] === clickedListItem) {                      index = nodeIndex;                      break;                  }                  nodeIndex++;              }              if (index >= 0) {                  // open PhotoSwipe if valid index found                  openPhotoSwipe(index, clickedGallery);              }              return false;          };          // parse picture index and gallery index from URL (#&pid=1&gid=2)          var photoswipeParseHash = function photoswipeParseHash() {              var hash = window.location.hash.substring(1),                  params = {};              if (hash.length < 5) {                  return params;              }              var vars = hash.split('&');              for (var i = 0; i < vars.length; i++) {                  if (!vars[i]) {                      continue;                  }                  var pair = vars[i].split('=');                  if (pair.length < 2) {                      continue;                  }                  params[pair[0]] = pair[1];              }              if (params.gid) {                  params.gid = parseInt(params.gid, 10);              }              return params;          };          var openPhotoSwipe = function openPhotoSwipe(index, galleryElement, disableAnimation, fromURL) {              var pswpElement = document.querySelectorAll('.pswp')[0],                  gallery,                  options,                  items;              items = parseThumbnailElements(galleryElement);              // define options (if needed)              options = {                  // define gallery index (for URL)                  galleryUID: galleryElement.getAttribute('data-pswp-uid'),                  getThumbBoundsFn: function getThumbBoundsFn(index) {                      // See Options -> getThumbBoundsFn section of documentation for more info                      var thumbnail = items[index].el.getElementsByTagName('img')[0],                          // find thumbnail                          pageYScroll = window.pageYOffset || document.documentElement.scrollTop,                          rect = thumbnail.getBoundingClientRect();                      return {                          x: rect.left,                          y: rect.top + pageYScroll,                          w: rect.width                      };                  }              };              // PhotoSwipe opened from URL              if (fromURL) {                  if (options.galleryPIDs) {                      // parse real index when custom PIDs are used                      // http://photoswipe.com/documentation/faq.html#custom-pid-in-url                      for (var j = 0; j < items.length; j++) {                          if (items[j].pid == index) {                              options.index = j;                              break;                          }                      }                  } else {                      // in URL indexes start from 1                      options.index = parseInt(index, 10) - 1;                  }              } else {                  options.index = parseInt(index, 10);              }              // exit if index not found              if (isNaN(options.index)) {                  return;              }              if (disableAnimation) {                  options.showAnimationDuration = 0;              }              // Pass data to PhotoSwipe and initialize it              gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, options);              gallery.init();              var $tempVideo;              var stopVideoHandle = function stopVideoHandle() {                  if ($tempVideo) {                      $tempVideo.remove();                      $tempVideo = null;                  }              };              var changeHandle = function changeHandle() {                  var item = gallery.currItem;                  stopVideoHandle();                  if (item.type === 'video') {                      var $ctn = item.container;                      var style = $ctn.getElementsByClassName('pswp__img')[0].style;                      var $video = document.createElement('video');                      $video.setAttribute('autoplay', 'autoplay');                      $video.setAttribute('controls', 'controls');                      $video.setAttribute('src', item.target);                      $video.style.width = style.width;                      $video.style.height = style.height;                      $video.style.position = 'absolute';                      $video.style.zIndex = 2;                      $tempVideo = $video;                      $ctn.appendChild($video);                  }              };              gallery.listen('initialZoomIn', changeHandle);              gallery.listen('afterChange', changeHandle);              gallery.listen('initialZoomOut', stopVideoHandle);          };          // loop through all gallery elements and bind events          var galleryElements = document.querySelectorAll(gallerySelector);          for (var i = 0, l = galleryElements.length; i < l; i++) {              galleryElements[i].setAttribute('data-pswp-uid', i + 1);              galleryElements[i].onclick = onThumbnailsClick;          }          // Parse URL and open gallery if it contains #&pid=3&gid=1          var hashData = photoswipeParseHash();          if (hashData.pid && hashData.gid) {              openPhotoSwipe(hashData.pid, galleryElements[hashData.gid - 1], true, true);          }      };      var Viewer = function() {          function init() {              initPhotoSwipeFromDOM('.photos');          }          return {              init: init          };      }();      module.exports = Viewer;      /***/  },  /* 3 */  /***/  function(module, exports) {      /* WEBPACK VAR INJECTION */      (function(global) {          module.exports = inViewport;          var instances = [];          var supportsMutationObserver = typeof global.MutationObserver === 'function';          function inViewport(elt, params, cb) {              var opts = {                  container: global.document.body,                  offset: 0              };              if (params === undefined || typeof params === 'function') {                  cb = params;                  params = {};              }              var container = opts.container = params.container || opts.container;              var offset = opts.offset = params.offset || opts.offset;              for (var i = 0; i < instances.length; i++) {                  if (instances[i].container === container) {                      return instances[i].isInViewport(elt, offset, cb);                  }              }              return instances[              instances.push(createInViewport(container)) - 1                  ].isInViewport(elt, offset, cb);          }          function addEvent(el, type, fn) {              if (el.attachEvent) {                  el.attachEvent('on' + type, fn);              } else {                  el.addEventListener(type, fn, false);              }          }          function debounce(func, wait, immediate) {              var timeout;              return function() {                  var context = this,                      args = arguments;                  var callNow = immediate && !timeout;                  clearTimeout(timeout);                  timeout = setTimeout(later, wait);                  if (callNow) func.apply(context, args);                  function later() {                      timeout = null;                      if (!immediate) func.apply(context, args);                  }              };          }          // https://github.com/jquery/sizzle/blob/3136f48b90e3edc84cbaaa6f6f7734ef03775a07/sizzle.js#L708          var contains = function() {              if (!global.document) {                  return true;              }              return global.document.documentElement.compareDocumentPosition ?                  function(a, b) {                      return !!(a.compareDocumentPosition(b) & 16);                  } :                  global.document.documentElement.contains ?                      function(a, b) {                          return a !== b && (a.contains ? a.contains(b) : false);                      } :                      function(a, b) {                          while (b = b.parentNode) {                              if (b === a) {                                  return true;                              }                          }                          return false;                      };          }          function createInViewport(container) {              var watches = createWatches();              var scrollContainer = container === global.document.body ? global : container;              var debouncedCheck = debounce(watches.checkAll(watchInViewport), 15);              addEvent(scrollContainer, 'scroll', debouncedCheck);              if (scrollContainer === global) {                  addEvent(global, 'resize', debouncedCheck);              }              if (supportsMutationObserver) {                  observeDOM(watches, container, debouncedCheck);              }              // failsafe check, every 200ms we check for visible images              // usecase: a hidden parent containing eleements              // when the parent becomes visible, we have no event that the children              // became visible              setInterval(debouncedCheck, 150);              function isInViewport(elt, offset, cb) {                  if (!cb) {                      return isVisible(elt, offset);                  }                  var remote = createRemote(elt, offset, cb);                  remote.watch();                  return remote;              }              function createRemote(elt, offset, cb) {                  function watch() {                      watches.add(elt, offset, cb);                  }                  function dispose() {                      watches.remove(elt);                  }                  return {                      watch: watch,                      dispose: dispose                  };              }              function watchInViewport(elt, offset, cb) {                  if (isVisible(elt, offset)) {                      watches.remove(elt);                      cb(elt);                  }              }              function isVisible(elt, offset) {                  if (!contains(global.document.documentElement, elt) || !contains(global.document.documentElement, container)) {                      return false;                  }                  // Check if the element is visible                  // https://github.com/jquery/jquery/blob/740e190223d19a114d5373758127285d14d6b71e/src/css/hiddenVisibleSelectors.js                  if (!elt.offsetWidth || !elt.offsetHeight) {                      return false;                  }                  var eltRect = elt.getBoundingClientRect();                  var viewport = {};                  if (container === global.document.body) {                      viewport = {                          top: -offset,                          left: -offset,                          right: global.document.documentElement.clientWidth + offset,                          bottom: global.document.documentElement.clientHeight + offset                      };                  } else {                      var containerRect = container.getBoundingClientRect();                      viewport = {                          top: containerRect.top - offset,                          left: containerRect.left - offset,                          right: containerRect.right + offset,                          bottom: containerRect.bottom + offset                      };                  }                  // The element must overlap with the visible part of the viewport                  var visible =                      (                          (eltRect.right > viewport.left) &&                          (eltRect.left < viewport.right) &&                          (eltRect.bottom > viewport.top) &&                          (eltRect.top < viewport.bottom)                      );                  return visible;              }              return {                  container: container,                  isInViewport: isInViewport              };          }          function createWatches() {              var watches = [];              function add(elt, offset, cb) {                  if (!isWatched(elt)) {                      watches.push([elt, offset, cb]);                  }              }              function remove(elt) {                  var pos = indexOf(elt);                  if (pos !== -1) {                      watches.splice(pos, 1);                  }              }              function indexOf(elt) {                  for (var i = watches.length - 1; i >= 0; i--) {                      if (watches[i][0] === elt) {                          return i;                      }                  }                  return -1;              }              function isWatched(elt) {                  return indexOf(elt) !== -1;              }              function checkAll(cb) {                  return function() {                      for (var i = watches.length - 1; i >= 0; i--) {                          cb.apply(this, watches[i]);                      }                  };              }              return {                  add: add,                  remove: remove,                  isWatched: isWatched,                  checkAll: checkAll              };          }          function observeDOM(watches, container, cb) {              var observer = new MutationObserver(watch);              var filter = Array.prototype.filter;              var concat = Array.prototype.concat;              observer.observe(container, {                  childList: true,                  subtree: true,                  // changes like style/width/height/display will be catched                  attributes: true              });              function watch(mutations) {                  // some new DOM nodes where previously watched                  // we should check their positions                  if (mutations.some(knownNodes) === true) {                      setTimeout(cb, 0);                  }              }              function knownNodes(mutation) {                  var nodes = concat.call([],                      Array.prototype.slice.call(mutation.addedNodes),                      mutation.target                  );                  return filter.call(nodes, watches.isWatched).length > 0;              }          }          /* WEBPACK VAR INJECTION */      }.call(exports, (function() {          return this;      }())))      /***/  }  /******/]);]]></content>
      
    </entry>
    
    
  
</search>
